\begin{itemize}
\item {\bf 1. kolo:}
Použijeme lineárnu aproximáciu $
x_{1,0} \oplus x_{1,2} \oplus x_{1,3}  \oplus k_{1} 
 \approx 
y_{1,1} $,
ktorá má balancie po jednotlivých S-boxoch $
-0.25,0.5,0.5,0.5
$čo podľa piling-up lemy dáva pravdepodobnosť 
$1/2 + 2^3*( -0.25)*(0.5)*(0.5)*(0.5 )= 0.25 $
Balancia je $-0.25$.

\item {\bf 2. kolo:}
Použijeme lineárnu aproximáciu $
x_{2,4}  \oplus k_{2} 
 \approx 
y_{2,4} $,
ktorá má balancie po jednotlivých S-boxoch $
0.5,0.25,0.5,0.5
$čo podľa piling-up lemy dáva pravdepodobnosť 
$1/2 + 2^3*( 0.5)*(0.25)*(0.5)*(0.5 )= 0.75 $
Balancia je $0.25$.

\item {\bf 3. kolo:}
Použijeme lineárnu aproximáciu $
x_{3,1}  \oplus k_{3} 
 \approx 
y_{3,0} \oplus y_{3,1} $,
ktorá má balancie po jednotlivých S-boxoch $
-0.25,0.5,0.5,0.5
$čo podľa piling-up lemy dáva pravdepodobnosť 
$1/2 + 2^3*( -0.25)*(0.5)*(0.5)*(0.5 )= 0.25 $
Balancia je $-0.25$.

\item {\bf Spolu:}  Máme lineárnu kombináciu $ \Big(
in_{0} \oplus in_{2} \oplus in_{3}
\Big) \oplus \Big( k_1 \oplus k_2 \oplus k_3 \oplus 
key_{1,0} \oplus key_{1,2} \oplus key_{1,3} \oplus key_{2,4} \oplus key_{3,1} \oplus key_{4,0} \oplus key_{4,4} \Big) \approx \Big(
out_{0} \oplus out_{1}
\Big) $.
Podľa piling-up lemy máme balanciu $4* -0.25*0.25*-0.25 ~= 0.0625 $.
\end{itemize}

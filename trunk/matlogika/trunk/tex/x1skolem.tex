\section{Skolemov tvar formuly}

\begin{definicia}[Skolemov normálny tvar]
  Uvažujme uzevretú formulu $A$.
  Ak $A$ má prefix $(\exists x_1)(\exists x_2) \dots (\exists x_k)
    (\forall x_{k+1}) (\forall x_{k+2}) \dots (\forall x_n)$, potom 
    hovoríme, že formula $A$ je vyjadrená v Skolemovom normálnom
    tvare, pričom $0 \le k \le n$.
\end{definicia}

\begin{veta}
    Nech $A$ je formula predikátovej logiky. Potom k nej môžeme
    zostrojiť formulu $A'$ v Skolemovom normálnom tvare, pričom platí
    $\provable A \Leftrightarrow \provable A'$.
    \label{veta:skolem}
\end{veta}

\begin{poznamka}
    Všimnime si, že predchádzajúca veta nehovorí nič o existencii
    formuly $A'$ takej, že $\provable A \leftrightarrow A'$ ako to
    bolo u prenexného tvaru. Taká formula totiž v prípade Skolemovho
    normálneho tvaru nemusí existovať.
\end{poznamka}

\begin{definicia}{Hodnosť formuly}
    Uvažujme formulu $A$ vyjadrenú v prenexnom tvare. Potom pod
    hodnosťou formuly $A$ označíme počet veľkých kvantifikátorov,
    ktoré v prefixe predchádzajú \emph{posledný} existenčný
    kvantifikátor (počítame zľava doprava).
\end{definicia}
\begin{priklad}
    \todo{ukazka hodnosti formuly na niecom}
\end{priklad}

\def\existsxton{(\exists x_1) (\exists x_2) \dots (\exists x_n)}
\def\forallxton{(\forall x_1) (\forall x_2) \dots (\forall x_n)}

\begin{dokaz}[vety \ref{veta:skolem}]
    Budeme predpokladať, že $A$ je uzavretá (Podľa vety o uzávere
    platí $\provable A$ práve vtedy, keď je dokázateľný jej uzáver.
    Dôkaz bude prebiehať matematickou indukciou vzhľadom na hodnosť
    $m$ formuly $A$.
    \begin{itemize}
        \item $m=0$ - $A$ je v Skolemovom normálnom tvare
        \item IP: tvrdenie vety platí pre každú
        formulu\footnote{používame tým pádom komplexnejší variant
        indukcie}, ktorej hodnosť je $\le m-1$.
        \begin{equation}
            A: \existsxton (\forall y) B(x_1,x_2,\dots,x_n,y)
        \end{equation}
        kde $b$ \emph{nie je} nutne bezkvantifikátorová.
        Predpokladajme, že v $B$ sú voľné iba $x_1,x_2,\dots,x_n,y$.
        Keďže hodnosť $A$ je $m$, tak vo formule $B$ poslednému
        existenčnému kvantifikátoru predchádza práve $m-1$ všeobecných
        kvantifikátorov.
        Nech $P^{n+1}$ je $n+1$-árny predikát, ktorý sa nevyskytuje v
        $A$ (a teda ani $B$). Uvažujme nasledujúcu formulu
        \begin{equation}
            A^*: \existsxton \left[
                (\forall y) (B(x_1,\dots,x_n,y) \implies 
                    P^{(n+1)}(x_1,\dots,x_n,y)) \implies 
                    (\forall y) P^{(n+1)} (x_1,\dots,x_n,y)
            \right]
        \end{equation}
        Postupne ukážeme, že $\provable A \Leftrightarrow \; \provable
        A^*$.
        \begin{itemize}
        \item[$\Rightarrow$]
            \begin{itemize}
            \item[0] $\provable A$
            \item[1] $\provable \highlightb{(B \implies P^{(n+1)}) \implies
                            (B \implies P^{(n+1)})}$ -- inštancia
                            $X\implies X$.
            \item[2] $\provable (X\implies (Y\implies Z)) \implies
                            (Y\implies (X\implies Z))$ -- veta o zámene
                            predpokladov
            \item[3] $\provable
                \highlightb{\underbrace{(B \implies P^{(n+1)})}_{X} \implies 
                        (\underbrace{B}_{Y} \implies
                        \underbrace{P^{(n+1)}}_{Z}))} \implies
                \highlighta{[ \underbrace{B}_{Y} \implies
                 (\underbrace{(B \implies P^{(n+1)})}_{X} \implies
                        \underbrace{P^{(n+1)}}_{Z})]}$ -- inštancia
                        kroku 2
            \item[4] $\provable
                 \highlighta{B \implies
                 ((B \implies P^{(n+1)}) \implies
                        P^{(n+1)}))}$ -- MP 1,3.\footnote{
                        Toman: Ideme to obliecť, zatiaľ je
                        obnažená.}

            \item[x] $\provable \highlightc{\highlighto{(\forall y)}
                B} \implies \highlighto{(\forall y)}(
                (B \implies P^{(n+1)}) \implies P^{(n+1)})$ --
                veta o distribúcii kvantifikátorov aplikovaná na
                5
            \item[y] $(\forall y)(
                (B \implies P^{(n+1)}) \implies P^{(n+1)})
                \implies
                \highlightb{(\highlighto{(\forall y)}(B \implies P^{(n+1)}) 
                    \implies
                     \highlighto{(\forall y)}P^{(n+1)})}$
                -- \fixme{z coho presne toto vyplyva?}

            \item[5] $\provable \highlightc{(\forall y) B} \implies 
                \highlightb{((\forall y)
                    (B \implies P^{(n+1)}) \implies
                    (\forall y) P^{(n+1)})}$ -- pravidlo jednoduchého sylogizmu
                    aplikované na x,y
                    \fixme{odtialto to zacina byt fakt bordel}
            \item[6] $\provable \highlighta{\existsxton} (\forall y) B \implies
                    \highlighta{\existsxton} \left[
                        (\forall y) (B \implies P^{(n+1)})
                        \implies (\forall y) P^{(n+1)}) \right]$ --
                    Dokážeme nasledovne:
                    $\provable (\forall x)(A \implies B) \implies
                     ((\exists x) A \implies (\exists x)B)$
                   \begin{itemize}
                    \item $\provable (\forall x)
                        (A \implies B) \implies
                        ((\forall x) A \implies (\forall x) B)$
                    \item $\provable (A \implies B) \leftrightarrow
                        (\neg B \implies \neg A)$
                    \item $\provable (\forall x) (\neg B \implies \neg
                    A) \implies ((\forall x) \neg B \implies
                      (\forall x) \neg A)$.
                    \item $\provable (\forall x) (\neg B \implies \neg
                    A) \implies (\neg (\forall x) \neg A \implies
                       \neg (\forall x) \neg B)$
                    \item $\provable (\forall x) (A \implies B)
                     \implies ( (\exists x) A \implies (\exists x) B)$
                   \end{itemize}
                \item[7] $\provable
                 \existsxton (\forall y) (B \implies P^{(n+1)})
                 \implies (\forall y) P^{(n+1)}$.
            \end{itemize}
            \vskip 0.5cm
        \item[$\Leftarrow$]
            \begin{itemize}
            \item[1] $\provable \highlightc{
                \existsxton [(\forall y) (B \implies B) 
                \implies (\forall y) B]}$
            \item[2] $\provable (\exists x) (A \implies B) \implies
                ((\forall x) A \implies (\exists x) B)$
                \begin{itemize}
                \item $\provable A \implies (\neg B \implies \neg (A
                        \implies B))$
                \item $\provable (\forall x) A \implies (\forall x) (\neg B
                   \implies \neg (A \implies B)$ -- veta o distribúcii
                   kvantifikátorov
                \item $(\forall x) A \provable
                    (\forall x) (\neg B \implies \neg (A \implies B)$
                    -- veta o dedukcii                    
                \item $(\forall x) A \provable
                    \highlighta{(\forall x) \neg B} \implies
                    \highlightb{(\forall x) \neg (A \implies B)}$ --
                    veta o distribúcii kvantifikátorov
                \item $(\forall x) A \provable
                    \highlightb{\highlightc{\neg} (\forall x) 
                                 \neg (A \implies B)} \implies
                    \highlighta{\highlightc{\neg} (\forall x) 
                                 \neg B}$ -- zámena implikácie
                \item $\highlighta{(\forall x)} A \provable
                    \highlightb{\highlightp{(\exists x)} (A \implies
                    B)} \implies
                    \highlightp{(\exists x)} B$ -- nahradenie
                    kvantifikátorov
                \item $\highlightb{(\exists x) (A \implies B)} \provable
                     \highlighta{(\forall x) A } \implies
                    (\exists x) B$ -- veta o dedukcii
                \end{itemize}
            \item[3] $\provable \highlightc{
                \existsxton [(\forall y) (B \implies B) 
                \implies  (\forall y) B]} \implies
                \highlighta{
                [ \forallxton (\forall y_n) (B \implies B)
                \implies \existsxton (\forall y) B]}$ -- $n$-krát
                použijeme 2.
            \item[4] $\provable \highlighta{
                \highlighto{\forallxton (\forall y_n) (B \implies B)}
                \implies \highlightp{\existsxton (\forall y) B}}$.
                -- MP 1,3
            \item[5]
                $\provable \highlighto{\forallxton (\forall y) (B
                \implies B)}$.
                -- $n+1$-krát pravidlo zovšeobecnenia použité na $B \implies B$
            \item[6]
                $\provable \highlightp{\existsxton (\forall y) B}$.
                -- MP 4,5
            \end{itemize}
            \vskip 0.5cm
            Ešte potrebujeme transformovať formulu $A^*$ na formulu s
            hodnosťou $m-1$. Nech
            $B: (Q_1 z_1)(Q_2 z_2) \dots (Q_l z_l) C$, kde $C$ je formula
            bez kvantifikátorov.
            \begin{itemize}
            \item
            $A^* \Leftrightarrow \highlightdim{\existsxton} \left( (\forall y)
                \left[ (Q_1 z_1) (Q_2 z_2) \dots (Q_l z_l) C \implies
                  P^{(n+1)} \right] \implies (\forall y) P^{(n+1)}\right)$

            \item
            $ \highlightdim{\existsxton} \left( (\forall y) (\overline{Q_1} z_1)
                        (\overline{Q_2} z_2) \dots
                        (\overline{Q_l} z_l) \left[
                            C \implies P^{(n+1)} \right]
                                \implies (\forall u)
                                    P^{(n+1)} \right)$ -- veta o variantoch
                                    + l prenexnych operacii c) alebo d)
            \item
            $ \highlightdim{\existsxton} \left( (\forall y) (\overline{Q_1} z_1)
                        (\overline{Q_2} z_2) \dots
                        (\overline{Q_l} z_l) \left[
                            C \implies P^{(n+1)} \right]
                                \implies (\forall u)
                                    P^{(n+1)} \right)$ -- veta o variantoch
            \item
            $ \highlightdim{\existsxton} \left( \fixme{(\exists y)} (\overline{Q_1} z_1)
                        (\overline{Q_2} z_2) \dots
                        (\overline{Q_l} z_l) \left[
                            C \implies P^{(n+1)} \right]
                                \implies (\forall u)
                                    P^{(n+1)} \right)$ -- ???
            \end{itemize}
        \end{itemize}
    \end{itemize}
\end{dokaz}

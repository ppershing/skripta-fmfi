\section{Skolemovské štandardné formuly}

\startFIXME

Procedúry založené na Herbrandovej myšlienke vyvrátenia (nájdenie interpretácie,
ktorá vyvracia danú formulu). Davis a Putnam pracovali s formulou v prefixovom
normálnom tvare a vychádzali z nasledujúcich hľadísk:
\begin{enumerate}
	\item Každá formula môže byť vyjadrená v prefixovom normálnom tvare.
	\item Pretože matica (jadro) neobsahuje kvantifikátory, môže byť
	vyjadrená v konjunktívnej normálnej forme.
	\item Zachovajúc nesplniteľnosť formúly môžeme z nej eliminovať
	existenčné kvantifikátory pomocou skolemovských funkcií (keď máme
	premennú vyjadrenú v prefixovom normálnom tvare a eliminujeme z nej
	existenčný kvantifikátor, dostaneme formulu, ktorá je nesplniteľná
	vtedy, keď je nesplniteľná pôvodná formula -- nesplniteľnosť
	transformovanej formuly sa robí ľahšie).
\end{enumerate}

Transformácia formuly. Majme formulu $A: (Q_1 x_1) (Q_2 x_2) \ldots (Q_n x_n)
M$, $M$ -- konjunktívny normálny tvar. $Q_r$ je existenčný kvantifikátor v
prefixe $(Q_1 x_1) \ldots (Q_n x_n)$, $1 \leq r \leq n$ vľavo od $Q_r$ nestojí
žiaden veľký kvantifikátor.
$A': Q_r$, $M$, za $x_r$ dosadíme $c$ ktorá v $M$.
$Q_{s_1}, Q_{s_2}, \ldots Q_{S_m}$ (zoznam všeob. kvantifikátorov) vľavo od
$Q_r$,  $1 \leq s_1 \leq s_2, \ldots \leq s_m < r$.

Za premennú $x_r$ dosadíme do $M$ term $f(x_{s_1}, \ldots, x_{s_m})$. Tieto
funkcie voláme Skolemove funkcie a $c$ voláme Skolemove konštanty.

\paragraph{Príklad.} Nájdite štandardnú formu pre formuly:
$$ (\exists x) (\forall y) (\forall z) (\exists u) (\forall v) (\exists w)
P(x,y,z,u,v,w)$$.
Premennú $x$ budeme nahrádzať konštantou $c$ (ktorá nie je v predikáte),
premennú $u$ nahradíme $f(y,z)$ a premennú $w$ nahradíme funkciou $g(y,z,v)$ .

$$ (\forall y)(\forall z)(\forall w) P(x,y,z,f(y,z),v,g(y,z,v)) $$

\paragraph{Príklad:} Nájdite štandardnú formulu: $$ (\forall x)(\exists y)
(\exists z) \left((\neg P(x,y) \land Q(x,z))\lor R(x,y,z)\right) $$.

$$ (\forall x) (\exists y) (\exists z)(\neg P(x,y) \lor R(x,y,z)) \land
(Q(x,z)\lor R(x,y,z))$$

$$ (\forall x) (\neg P(x,f(x)) \lor R(x,f(x),g(x)) \land Q(x,g(x))\lor
R(x,f(x),g(x)))$$

\paragraph{Definícia:} \emph{Literál} -- premenná, alebo jej negácia. 
\paragraph{Definícia:} \emph{Klauzula} -- disjunkcia literálov. \emph{Jednotková
klauzula} (tiež jednoliterálna klauzula) obsahuje jeden literál. 

\paragraph{Definícia:} \emph{Prázdna klauzula} neobsahuje žiaden literál
(označujeme ju $\square$). Prázdna klauzula je nesplniteľná.  

\par (niečo na tabuli)
$\{\neg P(x,y), R(x,y,z) \}$ \\
$P \lor Q$, $\{P, Q\}$

$y: f(x)$
$z: g(x)$

\stopFIXME

\begin{veta}
    Nech $\mathscr{S}$ je množina klauzúl, ktoré tvoria štandardnú
    formu formuly $A$. Potom $A$ nie je splniteľná $\iff$ $\mathscr{S}$
    nie je splniteľná.
\end{veta}

\begin{dokaz}
    Uvažujme formulu $A$ tvaru $A: (Q_1 x_1) \dots (Q_n x_n) M[x_1, \dots x_n]$.
    Nech $Q_r$ je prvý existenčný kvantifikátor, čiže $A$ je tvaru
    $(\forall x_1) (\forall x_2) \dots (\forall x_{r-1}) (\exists x_r)
     (Q_{r+1} x_{r+1}) \dots (Q_n x_n) M[x_1, \dots x_n]$.
    Existenčný kvantifikátor nahradíme novou $(r-1)$-árnou funkciou $f$ a
    dostávame formulu $A_1$ v tvare
    \begin{equation*}
        A_1: (\forall x_1) \dots (\forall x_{r-1}) (Q_{r+1} x_{r+1})  \dots (Q_n x_n)
                M[x_1, \dots, x_{r-1}, f(x_1, \dots, x_{r-1}), x_{r+1}, x_n]
    \end{equation*}

    \noindent Tvrdíme, že $A$ nie je splniteľná práve vtedy keď $A_1$ nie je splniteľná:
    \begin{itemize}
    %%% {{{
    \item[$\Rightarrow:$] Sporom. Nech $A_1$ je splniteľná.
        Potom $\forall x_1,\dots,x_{r-1}$ platí formula $A_1$, čize
        existuje taká interpretácia $I$, že $I$ vyhovuje $A_1$ ( $A_1$ je pravdivé v $I$).
        To znamená, že pre všetky $x_1 , \dots x_{r-1}$ existuje také $x_r$,
        ktoré je rovné $f(x_1, \dots, x_{r-1})$.
        Tá istá interpretácia teda vyhovuje aj pôvodnej formule $A$.

    \item[$\Leftarrow:$] Opäť sporom. Nech, že $A$ je splniteľná.
        Potom pre každé $x_1, \dots, x_{r-1}$ existuje také $x_r$, že platí 
        $M[x_1, \dots, x_{r-1}, x_r, \dots, x_n]$.
        Máme teda interpretáciu $I$ formuly $A$. Rozšírme $I$ o $(r-1)$-árny funkčný 
        symbol $f$ tak, že $f(x_1, \dots, x_{r-1}) = x_R$. Potom $I'$
        vyhovyje formule $A_1$ a teda dostávame spor.
    %%% }}}
    \end{itemize}

    \noindent Pokračujme ďalej v dôkaze:
    Označme pôvodnú formulu ako $A_0$. Potom môžeme dosiahnuť štandardnú formu
    $S$ ako postupnosť $A_0, A_1, \dots, A_m$, kde každý krok je zámena prvého
    existenčného kvantifikátora vo formule $A_i$.
    Ak $A_i$ nie je splniteľná, tak ani $A_{i+1}$ nie je splniteľná.
    Tým pádom $A_0$ nie je splniteľná $\iff$ $A_1$ nie je splniteľná $\iff
    \dots \iff$ $A_m\equiv S$ nie je splniteľná.
    No a $S$ nie je splniteľná práve vtedy keď $\mathscr{S}$ nie je
    splniteľná.
\end{dokaz}

\begin{poznamka}
    Ak $A$ \emph{nie je splniteľná}, potom môžeme písať
    $A \equiv \mathscr{S}$.
\end{poznamka}

\begin{poznamka}
    Ak $A$ je splniteľná, tak tvrdenie neplatí.
    Majme formulu $A$, ktorá je $A: (\exists x) P(x)$.
    Tým pádom $S$ je $S: P(a)$ ($x$ sme nahradili skolemovskou
    konštantou $a$).
    Vezmime interpretáciu s univerzom $D = \{1, 2 \}$,
    pričom $a$ priradíme v $I$ hodnotu $1$.
    Hodnoty pre $P$ budú $P(1)=false, P(2)=true$.
    Potom ale $A$ je splniteľná v $I$ (existuje také $x$, menovite
    $2$), lenže $P(a)$ nie je splniteľná.
    Preto $A \not \equiv S$.
\end{poznamka}

\begin{poznamka}
    Z predchádzajúcej poznámky sa ukazuje, že metódy dokazovania
    formúl budú založené na vyvrátení negácie.
\end{poznamka}

\begin{poznamka}
    Majme formulu $A: A_1 \land A_2 \land \ldots \land A_n$.
    Pre každé $A_i$ si vytvoríme štandardnú formulu $S_i$.
    Potom štandardná forma pre $A$ je 
    $\mathscr{S}=\mathscr{S_1} \union \mathscr{S_2} 
                \union \ldots \union \mathscr{S_m}$,
    kde $\mathscr{S_i}$ je množina klauzúl štandardnej formu $S_i$.
    Formula $A$ nie je splniteľná práve vtedy, keď nie je 
    splniteľná množina klauzúl $\mathscr{S}$.
\end{poznamka}

\begin{priklad}[Z teórie grúp]
    Uvedieme príklad, kde sa pokúsime zapísať pomocou množiny
    klauzúl tvrdenie z teórie grúp. 

    \par Uvažujme grupu a na nej operáciu $\circ$.
    Platia nasledovné axiomy:
    \begin{itemize}
    %%% {{{
        \item [$A_1:$] $x, y \in G \Rightarrow x \circ y \in G$ --
                vlastnosť uzavretosti.
        \item [$A_2:$] $x, y, z \in G \Rightarrow 
                        (x \circ y) \circ z = x \circ (y \circ z)$ --
                asociatívnosť operácie.
        \item [$A_3:$] $x \in G \Rightarrow x \circ e = e \circ x = x$ --
                existencia neutrálneho prvku.
        \item [$A_4:$] $x \in G \Rightarrow \exists x^{-1} \in G :
                            x \circ x^{-1} = e = x^{-1} \circ x$ --
                existencia inverzného prvku.
    %%% }}}
    \end{itemize}

    Chceme ukázať, že ak pre všetky $x \in G$ platí $x \circ x \in G$,
    potom je grupa komutatívna. Prvou časťou úlohy je formalizovanie zadania:
    Nech $P(x,y,z)$ označuje $x \circ y = z$ a nech  $i(x) =
    x^{-1}$.\footnote{ % o tom, ze to ma Toman zle
        %%% {{{
        Na tomto mieste by som poznamenal, že to má Toman zle.
        Totiž, nahradením funkcie predikátom sme stratili jednoznačnosť
        funkčnej hodnoty, teda, momentálne môže platiť
        $P(x,y,z) \land P(x,y,z') \land z \ne z'$. Jednoduchou
        interpretáciou, ktorá spĺňa všetky axiómy je napríklad
        $P \equiv true$ a evidentne takáto realizácia nie je teóriou grúp.
        Riešenie je buď pridať piatu axiómu obmedzujúcu $P$ alebo naozaj
        používať funkčný symbol namiesto predikátového. Každopádne, zvyšok
        tohoto príkladu bude podľa Tomana.
        %%% }}}
    }

    Prepísané axiómy vyzerajú nasledovne:
    \begin{align*}
    %%% {{{
        A_1':\ &(\forall x) (\forall y) (\exists z) P(x,y,z) \\
        A_2': 
            \begin{split}
                & \phantom{\land (} (\forall x) (\forall y) (\forall z)
                (\forall u) (\forall v) (\forall w)
                [ (P(x,y,u) \land  P(y,z,v) \land P(u, z, w))
                    \implies P(x,v,w)] \\ 
                &\land (\forall x) (\forall y)(\forall z)
                (\forall u)(\forall v) (\forall w)
                [(P(x,y,u) \land P(y,z,v) \land P(x,v,w)) \implies P(u,z,w)]
            \end{split} \\
        A_3':\ &(\forall x) P(x,e,x) \land (\forall x) P(e,x,x) \\
        A_4':\ &(\forall x) P(x,i(x),e) \land (\forall x) P(i(x),x,e)
    %%% }}}
    \end{align*}

    Späť k nášmu tvrdeniu. Chceme ukázať
    \begin{align*}
    %%% {{{
        &(\forall x \in G : x \circ x \in G) \then
            (\forall u,v \in G: u \circ v = v \circ u) \\
        B':\ & (\forall x) P(x,x,e) \implies  
            (\forall u) (\forall v) [P(u,v,w) \implies P(v,u,w)]
    %%% }}}
    \end{align*}

    Teraz potrebujeme ukázať, že
    $A_1' \land A_2' \land A_3' \land  A_4' \implies B'$.
    Vytvoríme negáciu výroku a ukážeme, že nie je splniteľná:
    \begin{align*}
        F':\ & \neg (A_1' \land A_2' \land A_3' \land A_4') \lor B' \\
      \neg F':\ & A_1' \land A_2' \land A_3' \land A_4' \land \neg B'
    \end{align*}

    Ideme vytvárať množinu klauzúl. Prevedením $A_1', A_2', A_3', A_4'$ do
    štandardnej formy dostávame
    \begin{align*}
    %%% {{{
        \mathscr{S}_1:\ & \Big\{ P(x,y,f(x,y)) \Big\} \\
        \mathscr{S}_2:\ 
            \begin{split}
                 &\Big\{ \neg P(x,y,u) \lor \neg P(y,z,v)
                    \lor \neg P(u,z,w) \lor P(x,v,w), \\
                 &\ \ \neg P(x,y,u)\lor \neg P(y,z,v) \lor \neg P(x,v,q)
                    \lor P(u,z,w) \Big\}
            \end{split} \\
        \mathscr{S}_3:\ & \Big\{ P(x,e,x), \ P(e,x,x) \Big\} \\
        \mathscr{S}_4:\ & \Big\{ P(x,i(x),e), \ P(i(x),x,e) \Big\}
    %%% }}}
    \end{align*}

    Ostáva nám vyjadriť $\neg B'$ ako množinu $\mathscr{B}$.
    \begin{align*}
    %%% {{{
        \neg B':\ &
            \neg [(\forall x) P(x,x,e) \implies
                    (\forall u) (\forall v)(\forall w)(P(u,v,w) \implies
                    P(v,u,w))] \iff \\
        & \neg [ \neg (\forall x) (P(x,x,e)
                \lor (\forall u) (\forall v) (\forall w)
                    (\neg P(u,v,w) \lor P(v,u,w))] \iff \\
        &(\forall x) (P(x,x,e) \land \neg (\forall u)(\forall v) (\forall w) 
          [\neg P(u,v,w) \lor (P(v,u,w)] \iff \\
        & (\forall x) P(x,x,e)
            \land (\exists u) (\exists v) (\exists w)
                    [P(u,v,w)\land \neg P(v,u,w)]
    %%% }}}
    \end{align*}

    Množina $\mathscr{B}$ je potom
    \begin{equation*}
        \mathscr{B}:\  \Big\{P(x,x,e),\ P(a,b,c),\ \neg P(b,a,c) \Big\}
    \end{equation*}

    Máme dokázať, že množina klauzúl 
    $\mathscr{S} = \mathscr{S}_1 \union \mathscr{S}_2 \union
        \mathscr{S}_3 \union \mathscr{S}_4 \union \mathscr{B}$
    nie je splniteľná. Teda pre každú oblasť a interpretáciu je
    nesplniteľná.
    Bolo by teda potrebné vyšetriť všetky oblasti.
    Toto je ale príliš zložité -- overiť niečo na všetkých možných
    oblastiach je nad naše sily.
    Nám ale bude stačiť vyšetrovať na \emph{Herbrandovskom univerze},
    ako si ukážeme v nasledujúcej stati.
\end{priklad}
